<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PIQL.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://chelate.github.io/PIQL.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PIQL.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/chelate/PIQL.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PIQL"><a class="docs-heading-anchor" href="#PIQL">PIQL</a><a id="PIQL-1"></a><a class="docs-heading-anchor-permalink" href="#PIQL" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/chelate/PIQL.jl">PIQL</a>.</p><ul><li><a href="#PIQL.ControlProblem"><code>PIQL.ControlProblem</code></a></li><li><a href="#PIQL.PVActor"><code>PIQL.PVActor</code></a></li><li><a href="#PIQL.PiqlParticle"><code>PIQL.PiqlParticle</code></a></li><li><a href="#PIQL.empty_actor-Tuple{}"><code>PIQL.empty_actor</code></a></li><li><a href="#PIQL.initial_state_action-Tuple{ControlProblem, Any}"><code>PIQL.initial_state_action</code></a></li><li><a href="#PIQL.qestimate-NTuple{4, Any}"><code>PIQL.qestimate</code></a></li><li><a href="#PIQL.run_piql!-Tuple{Any, Any, Any}"><code>PIQL.run_piql!</code></a></li><li><a href="#PIQL.step_choices-Tuple{}"><code>PIQL.step_choices</code></a></li><li><a href="#PIQL.train!-Tuple{TabularActor, Any}"><code>PIQL.train!</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="PIQL.ControlProblem" href="#PIQL.ControlProblem"><code>PIQL.ControlProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><p>ControlProblem is a struct with fields that are      the functions which completely define a KL-control problem</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/control_problem.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.PVActor" href="#PIQL.PVActor"><code>PIQL.PVActor</code></a> — <span class="docstring-category">Type</span></header><section><div><p>We write this as a separation between policy and value function The policy is representable as a set of unnormalized weights w_i so that </p><p>log(p<em>i) = log(w</em>i) - log(sum(w))  η<em>i = log(w</em>i/π<em>i) - log(sum(w))  η</em>i = ω<em>i - log(sum(π</em>i * exp(ω_i)))</p><p>The ω<em>i = log(w</em>i/π_i) have an estimator in</p><p>β(criticq - actorv)<em>i = hatω</em>i =&gt; ω_i</p><p>There&#39;s no exponential sampling that needs to be averaged so we can simply update (with a pretty strong learning rate.)</p><p>ω<em>i(t+1) = ω</em>i(t) + α (hatω<em>i -  ω</em>i(t))</p><p>at the same time, the actorq can be generated</p><p>actorq<em>i = η</em>i / β + actorv<em>i = (ω</em>i - log(Ξ)) / β + actorv</p><p>and it can be constructed from </p><p>actorq<em>i = η</em>i / β + actorv<em>i = (q</em>i - log(Ξ)) / β + actorv</p><p>v = sum(π<em>i exp(β*actor</em>qi)) / β w = β * (actorq_i - v)</p><p>Still experimental, loss interest after TabActor update rule didn&#39;t work.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/Actors/TabularPV.jl#L3-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.PiqlParticle" href="#PIQL.PiqlParticle"><code>PIQL.PiqlParticle</code></a> — <span class="docstring-category">Type</span></header><section><div><p>current StateAction definition:</p><p>struct StateAction{S,A} # static and constructed on forward pass     # atomic unit of data for all reinforcement learning     # includes all information and diagnostics available from a single step.     state::S     action::A     β::Float64 # the beta under which the temperature is allowed to fluxuate     actorq::Float64     criticq::Float64     reward::Float64 # actually incurred cost entering the state     V::Float64 # free energy of current action (observed value)     U::Float64 # average energy of current action end</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/piql_data.jl#L18-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.empty_actor-Tuple{}" href="#PIQL.empty_actor-Tuple{}"><code>PIQL.empty_actor</code></a> — <span class="docstring-category">Method</span></header><section><div><p>We define an actor interface: an actor is a callable struct</p><p>struct GenericActor     parameters</p><p>end</p><p>function (a::Actor)(state,action)     ...     return E_actor end</p><p>function loss(actor, minibatch)     ...     return E_actor end</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/Actors/EmptyActor.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.initial_state_action-Tuple{ControlProblem, Any}" href="#PIQL.initial_state_action-Tuple{ControlProblem, Any}"><code>PIQL.initial_state_action</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Start off a trajectory with a new state action pair</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/control_problem.jl#L34-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.qestimate-NTuple{4, Any}" href="#PIQL.qestimate-NTuple{4, Any}"><code>PIQL.qestimate</code></a> — <span class="docstring-category">Method</span></header><section><div><p>z(t) = exp(β(criticq - actorq)) (γ z(t+1) + (1-γ)) z(t) = exp(β(criticq - actorq)) (γ (z(t+1)-1) + 1) logz(t) = β(criticq - actorq) +  log(γ<em>(z(t+1)-1) + 1) = β(criticq - actorq) +  logp1(γ</em>expm1(logz(t+1)))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/piql_data.jl#L82-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.run_piql!-Tuple{Any, Any, Any}" href="#PIQL.run_piql!-Tuple{Any, Any, Any}"><code>PIQL.run_piql!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Expected dynamics: grow the worldline until the terminal condition. then backpropogate weights and return terminated = true</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/piql_data.jl#L53-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.step_choices-Tuple{}" href="#PIQL.step_choices-Tuple{}"><code>PIQL.step_choices</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Actions are indexed by natural numbers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/ControlProblems/gridworld.jl#L18-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PIQL.train!-Tuple{TabularActor, Any}" href="#PIQL.train!-Tuple{TabularActor, Any}"><code>PIQL.train!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Destructive memory training, storing partition function memory is composed of struct (at time of writing) consisting of</p><pre><code class="nohighlight hljs">struct QEstimate{S,A}
    sa::StateAction{S,A} # the state action information at this time step
    criticq::Float64 # from the state one step forward in time
    logz::Float64 # log z at state in sa.state
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/chelate/PIQL.jl/blob/5a31a9a515dbcb48ef6213a014ca702625183e93/src/Actors/TabularActor.jl#L74-L84">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 28 March 2023 12:22">Tuesday 28 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
